<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>VolleyLink - 대학 배구 교류전 플랫폼</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- 스타일 파일 연결 -->
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <!-- 상단 바 -->
  <header class="top-bar">
    <div class="top-bar__left">
      <span class="logo">VolleyLink</span>
      <span class="logo-sub">대학 배구 교류전</span>
    </div>
    <!-- 로그인 / 로그아웃 버튼 (상태에 따라 텍스트 변경됨) -->
    <button id="authButton" class="btn btn-outline btn-small">로그인</button>
  </header>

  <main class="page">
    <!-- 히어로 영역 -->
    <section class="hero">
      <h1>주장님, 오늘은<br>어디로 교류전 가실래요?</h1>
      <p>
        전국 대학 배구 동아리 교류전을 한 곳에서 관리하고,<br>
        실력·지역·성별에 맞는 팀과 안전하게 매칭해요.
      </p>
      <div class="hero-cta-row">
        <button class="btn btn-primary">내 팀 등록하기</button>
        <button class="btn btn-secondary">교류전 둘러보기</button>
      </div>
    </section>

    <!-- 탭 네비게이션 -->
    <nav class="tab-nav">
      <button class="tab-nav__item tab-nav__item--active" data-tab="matches">매치 찾기</button>
      <button class="tab-nav__item" data-tab="locker">팀 라커룸</button>
      <button class="tab-nav__item" data-tab="ranking">랭킹</button>
    </nav>

    <!-- 매치 찾기 탭 -->
    <section id="tab-matches" class="tab-content tab-content--active">
      <!-- 필터 영역 -->
      <div class="card">
        <h2 class="section-title">매치 조건 선택</h2>
        <div class="filter-row">
          <div class="filter-group">
            <label class="filter-label">게임 방식</label>
            <div class="chip-row">
              <button class="chip chip--active">9인제</button>
              <button class="chip">6인제</button>
            </div>
          </div>
          <div class="filter-group">
            <label class="filter-label">성별</label>
            <div class="chip-row">
              <button class="chip chip--active">남자</button>
              <button class="chip">여자</button>
              <button class="chip">혼성</button>
            </div>
          </div>
        </div>

        <div class="filter-row">
          <div class="filter-group full">
            <label class="filter-label">지역</label>
            <select class="select">
              <option>전체 지역</option>
              <option>서울권</option>
              <option>경기/인천</option>
              <option>충청/천안권</option>
              <option>기타 지역</option>
            </select>
          </div>
        </div>

        <input
          class="input"
          type="text"
          placeholder="학교명 또는 동아리명을 검색해보세요 (예: 한신대 비상)"
        />
      </div>

      <!-- 매치 카드 리스트 -->
      <section class="section-spacing">
        <div class="section-header">
          <h2 class="section-title">오늘 모집 중인 교류전</h2>
          <button class="link-button">전체 보기</button>
        </div>

        <article class="match-card">
          <div class="match-card__header">
            <div>
              <div class="badge-row">
                <span class="badge badge--green">모집 중</span>
                <span class="badge">9인제</span>
                <span class="badge">남자부</span>
              </div>
              <h3>한신대 비상 vs 연세대 블루</h3>
            </div>
            <span class="match-level">중상 · 친선/연습 가능</span>
          </div>

          <div class="match-card__body">
            <div class="match-info-row">
              <span class="match-label">일시</span>
              <span class="match-value">11월 24일 (금) 18:00</span>
            </div>
            <div class="match-info-row">
              <span class="match-label">장소</span>
              <span class="match-value">한신대학교 체육관</span>
            </div>
            <div class="match-info-row">
              <span class="match-label">비고</span>
              <span class="match-value">주차 협소 · 경기 영상 촬영 예정</span>
            </div>
          </div>

          <div class="match-card__footer">
            <button class="btn btn-outline btn-small">상세 보기</button>
            <button class="btn btn-primary btn-small">매칭 지원하기</button>
          </div>
        </article>

        <article class="match-card">
          <div class="match-card__header">
            <div>
              <div class="badge-row">
                <span class="badge badge--green">모집 중</span>
                <span class="badge">6인제</span>
                <span class="badge">혼성</span>
              </div>
              <h3>고려대 RED vs 한체대 KNSU</h3>
            </div>
            <span class="match-level">상 · 공식전 연습</span>
          </div>

          <div class="match-card__body">
            <div class="match-info-row">
              <span class="match-label">일시</span>
              <span class="match-value">11월 30일 (토) 14:00</span>
            </div>
            <div class="match-info-row">
              <span class="match-label">장소</span>
              <span class="match-value">고려대학교 화정체육관</span>
            </div>
            <div class="match-info-row">
              <span class="match-label">비고</span>
              <span class="match-value">심판 가능 · 볼 지참</span>
            </div>
          </div>

          <div class="match-card__footer">
            <button class="btn btn-outline btn-small">상세 보기</button>
            <button class="btn btn-primary btn-small">매칭 지원하기</button>
          </div>
        </article>
      </section>
    </section>

    <!-- 팀 라커룸 탭 -->
    <section id="tab-locker" class="tab-content">
      <section class="card">
        <h2 class="section-title">라커룸 - 한신대 비상</h2>
        <p class="subtitle">Hanshin Univ. Bisang</p>

        <div class="stats-row">
          <div class="stat-box">
            <span class="stat-label">경기수</span>
            <span class="stat-value">25</span>
          </div>
          <div class="stat-box">
            <span class="stat-label">승리</span>
            <span class="stat-value">22</span>
          </div>
          <div class="stat-box">
            <span class="stat-label">승률</span>
            <span class="stat-value stat-value--green">88%</span>
          </div>
        </div>

        <div class="divider"></div>

        <div class="section-header">
          <h3 class="section-title small">선수 명단</h3>
          <button class="btn btn-outline btn-small">새 선수 등록</button>
        </div>

        <div class="position-row">
          <span class="position-chip">L</span>
          <span class="position-chip">S</span>
          <span class="position-chip">OH</span>
          <span class="position-chip">OP</span>
          <span class="position-chip">MB</span>
        </div>

        <p class="helper-text">
          실제 서비스에서는 포지션별로 선수 이름과 학번, 주포지션/부포지션을 등록할 수 있어요.
        </p>
      </section>
    </section>

    <!-- 랭킹 탭 -->
    <section id="tab-ranking" class="tab-content">
      <section class="card">
        <div class="section-header">
          <h2 class="section-title">실시간 랭킹</h2>
          <span class="subtitle">승률 기준 · 최소 10경기 이상 팀</span>
        </div>

        <ol class="ranking-list">
          <li class="ranking-item">
            <span class="ranking-pos">1</span>
            <div class="ranking-main">
              <span class="ranking-team">한체대 KNSU</span>
              <span class="ranking-sub">서울 · 남자부 9인제</span>
            </div>
            <span class="ranking-rate">92%</span>
          </li>
          <li class="ranking-item">
            <span class="ranking-pos">2</span>
            <div class="ranking-main">
              <span class="ranking-team">한신대 비상</span>
              <span class="ranking-sub">경기 · 혼성 9인제</span>
            </div>
            <span class="ranking-rate">88%</span>
          </li>
          <li class="ranking-item">
            <span class="ranking-pos">3</span>
            <div class="ranking-main">
              <span class="ranking-team">연세대 배구부</span>
              <span class="ranking-sub">서울 · 남자부 6인제</span>
            </div>
            <span class="ranking-rate">85%</span>
          </li>
          <li class="ranking-item">
            <span class="ranking-pos">4</span>
            <div class="ranking-main">
              <span class="ranking-team">서울대학교</span>
              <span class="ranking-sub">서울 · 혼성 9인제</span>
            </div>
            <span class="ranking-rate">70%</span>
          </li>
          <li class="ranking-item">
            <span class="ranking-pos">5</span>
            <div class="ranking-main">
              <span class="ranking-team">고려대학교</span>
              <span class="ranking-sub">서울 · 남자부 6인제</span>
            </div>
            <span class="ranking-rate">60%</span>
          </li>
        </ol>
      </section>
    </section>
  </main>

  <!-- 항상 보이는 플로팅 CTA -->
  <button class="floating-cta">
    + 새 교류전 만들기
  </button>

  <!-- 🔒 로그인/회원가입 모달 -->
  <div id="authModal" class="modal hidden">
    <div class="modal-backdrop"></div>
    <div class="modal-content">
      <h2 id="authModalTitle">로그인</h2>
      <p id="authModalSub" class="modal-sub">
        이메일로 로그인하고 팀 라커룸을 관리해보세요.
      </p>

      <input id="emailInput" class="input" type="email" placeholder="대학 이메일 주소" />
      <input id="passwordInput" class="input" type="password" placeholder="비밀번호 (6자 이상)" />

      <p id="authError" class="auth-error hidden"></p>

      <div class="modal-actions">
        <button id="authSubmit" class="btn btn-primary btn-small">로그인</button>
        <button id="closeModal" class="btn btn-outline btn-small">취소</button>
      </div>

      <p class="helper-text">
        <span id="authToggleText">아직 계정이 없나요?</span>
        <button type="button" id="authToggleButton" class="modal-link">
          회원가입으로 전환
        </button>
      </p>

      <!-- 👉 여기 안내 문구: 도메인 안 맞아서 가입 안 될 때 안내 -->
      <p class="helper-text helper-text-secondary">
        회원가입이 되지 않을 경우, 사용 중인 학교 계정 도메인(예: <strong>xxxx@학교이름.ac.kr</strong>)을
        운영진에게 보내주시면 등록해 드리겠습니다.<br />
        예) <strong>hs.ac.kr, yonsei.ac.kr</strong> 등
      </p>
    </div>
  </div>

  <!-- 🔧 Firebase SDK (compat 버전) -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

  <!-- 🔧 메인 스크립트 -->
  <script>
    // 1) Firebase 설정 (네 콘솔 값 넣기)
    const firebaseConfig = {
      apiKey: "여기에_네_apiKey",
      authDomain: "여기에_네_authDomain",
      projectId: "여기에_네_projectId",
      storageBucket: "여기에_네_storageBucket",
      messagingSenderId: "여기에_네_messagingSenderId",
      appId: "여기에_네_appId",
      measurementId: "여기에_네_measurementId"
    };

    // 2) 허용할 학교 이메일 도메인 목록 (서울/수도권/천안권 1차 버전)
    const allowedDomains = [
      // 서울권
      "snu.ac.kr", "yonsei.ac.kr", "korea.ac.kr", "ewha.ac.kr", "sogang.ac.kr",
      "hanyang.ac.kr", "cau.ac.kr", "duksung.ac.kr", "dgu.ac.kr", "uos.ac.kr",
      "skku.edu", "sju.ac.kr", "sejong.ac.kr", "hansung.ac.kr", "hongik.ac.kr",
      "sookmyung.ac.kr", "konkuk.ac.kr", "kookmin.ac.kr", "kw.ac.kr",
      "sungshin.ac.kr",

      // 인천·경기권
      "inha.ac.kr", "inu.ac.kr", "gachon.ac.kr", "ajou.ac.kr", "kyonggi.ac.kr",
      "hs.ac.kr", "dankook.ac.kr", "catholic.ac.kr", "su.ac.kr", "khu.ac.kr",
      "eulji.ac.kr", "smu.ac.kr", "hknu.ac.kr",

      // 천안·아산권
      "koreatech.ac.kr", "cheonan.ac.kr", "kongju.ac.kr", "sch.ac.kr",
      "hoseo.edu", "cjnu.ac.kr", "baewha.ac.kr"
    ];

    // 3) Firebase 초기화
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    // 4) 로그인/회원가입 관련 DOM
    const authButton = document.getElementById("authButton");
    const authModal = document.getElementById("authModal");
    const closeModal = document.getElementById("closeModal");
    const authSubmit = document.getElementById("authSubmit");
    const emailInput = document.getElementById("emailInput");
    const passwordInput = document.getElementById("passwordInput");
    const authError = document.getElementById("authError");
    const authModalTitle = document.getElementById("authModalTitle");
    const authModalSub = document.getElementById("authModalSub");
    const authToggleText = document.getElementById("authToggleText");
    const authToggleButton = document.getElementById("authToggleButton");

    let isSignupMode = false; // false면 로그인, true면 회원가입

    function openModal() {
      authModal.classList.remove("hidden");
      authError.classList.add("hidden");
      authError.textContent = "";
    }

    function closeAuthModal() {
      authModal.classList.add("hidden");
    }

    function updateAuthModeUI() {
      if (isSignupMode) {
        authModalTitle.textContent = "회원가입";
        authModalSub.textContent = "새 계정을 만들고 팀 교류전을 관리해보세요.";
        authSubmit.textContent = "회원가입";
        authToggleText.textContent = "이미 계정이 있나요?";
        authToggleButton.textContent = "로그인으로 전환";
      } else {
        authModalTitle.textContent = "로그인";
        authModalSub.textContent = "이메일로 로그인하고 팀 라커룸을 관리해보세요.";
        authSubmit.textContent = "로그인";
        authToggleText.textContent = "아직 계정이 없나요?";
        authToggleButton.textContent = "회원가입으로 전환";
      }
    }

    // 모드 전환 버튼
    authToggleButton.addEventListener("click", () => {
      isSignupMode = !isSignupMode;
      updateAuthModeUI();
      authError.classList.add("hidden");
      authError.textContent = "";
    });

    // 상단 로그인 버튼 클릭 시
    authButton.addEventListener("click", () => {
      if (auth.currentUser) {
        // 이미 로그인 상태면 → 로그아웃
        auth.signOut();
      } else {
        // 로그아웃 상태면 → 로그인/회원가입 모달 열기
        isSignupMode = false; // 기본은 로그인
        updateAuthModeUI();
        openModal();
      }
    });

    // 모달 닫기
    closeModal.addEventListener("click", closeAuthModal);

    // 로그인/회원가입 시도
    authSubmit.addEventListener("click", () => {
      const email = emailInput.value.trim();
      const password = passwordInput.value;

      if (!email || !password) {
        authError.textContent = "이메일과 비밀번호를 모두 입력해주세요.";
        authError.classList.remove("hidden");
        return;
      }

      if (password.length < 6) {
        authError.textContent = "비밀번호는 6자 이상이어야 합니다.";
        authError.classList.remove("hidden");
        return;
      }

      // 이메일 형식 & 도메인 체크 (회원가입 모드일 때만)
      const emailParts = email.split("@");
      if (emailParts.length !== 2) {
        authError.textContent = "올바른 이메일 형식을 입력해주세요.";
        authError.classList.remove("hidden");
        return;
      }
      const emailDomain = emailParts[1];

      if (isSignupMode) {
        if (!allowedDomains.includes(emailDomain)) {
          authError.innerHTML =
            "해당 이메일 도메인은 현재 등록되어 있지 않습니다.<br>" +
            "사용 중인 학교 계정 도메인(예: <strong>hs.ac.kr</strong>)을 운영진에게 보내주시면 추가 등록해 드릴게요.";
          authError.classList.remove("hidden");
          return;
        }
      }

      authError.classList.add("hidden");
      authError.textContent = "";

      if (isSignupMode) {
        // 회원가입
        auth
          .createUserWithEmailAndPassword(email, password)
          .then((userCredential) => {
            console.log("회원가입 & 자동 로그인 성공:", userCredential.user.email);
            closeAuthModal();
            emailInput.value = "";
            passwordInput.value = "";
          })
          .catch((error) => {
            console.error(error);
            authError.textContent =
              "회원가입 실패: 이미 사용 중인 이메일이거나 형식이 올바르지 않습니다.";
            authError.classList.remove("hidden");
          });
      } else {
        // 로그인
        auth
          .signInWithEmailAndPassword(email, password)
          .then((userCredential) => {
            console.log("로그인 성공:", userCredential.user.email);
            closeAuthModal();
            emailInput.value = "";
            passwordInput.value = "";
          })
          .catch((error) => {
            console.error(error);
            authError.textContent =
              "로그인 실패: 이메일 또는 비밀번호를 확인해주세요.";
            authError.classList.remove("hidden");
          });
      }
    });

    // 엔터키로도 동작
    [emailInput, passwordInput].forEach((el) => {
      el.addEventListener("keydown", (e) => {
        if (e.key === "Enter") {
          authSubmit.click();
        }
      });
    });

    // 로그인 상태 감지해서 버튼 상태 바꾸기
    auth.onAuthStateChanged((user) => {
      if (user) {
        authButton.textContent = "로그아웃";
        authButton.classList.remove("btn-outline");
        authButton.classList.add("btn-secondary");
      } else {
        authButton.textContent = "로그인";
        authButton.classList.remove("btn-secondary");
        authButton.classList.add("btn-outline");
      }
    });

    // 탭 전환 로직
    const tabButtons = document.querySelectorAll(".tab-nav__item");
    const tabContents = document.querySelectorAll(".tab-content");

    tabButtons.forEach((btn) => {
      btn.addEventListener("click", () => {
        const target = btn.dataset.tab;

        tabButtons.forEach((b) =>
          b.classList.remove("tab-nav__item--active")
        );
        btn.classList.add("tab-nav__item--active");

        tabContents.forEach((c) => {
          c.classList.toggle(
            "tab-content--active",
            c.id === "tab-" + target
          );
        });
      });
    });
  </script>
</body>
</html>
